"use strict";(self.webpackChunkZeblog=self.webpackChunkZeblog||[]).push([[5689],{98243:(e,n,i)=>{i.r(n),i.d(n,{default:()=>Wi});var r=i(4270);const d=(0,r._)("h1",{id:"springboot-拦截器-自定义异常-自定义注解-全局异常处理",tabindex:"-1"},[(0,r._)("a",{class:"header-anchor",href:"#springboot-拦截器-自定义异常-自定义注解-全局异常处理","aria-hidden":"true"},"#"),(0,r.Uk)(" SpringBoot+拦截器+自定义异常+自定义注解+全局异常处理")],-1),t={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},a=(0,r.Uk)("前言"),l={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},s=(0,r.Uk)("资源权限"),c={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},f=(0,r.Uk)("1.静态资源准备"),o={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},b=(0,r.Uk)("2.自定义一个异常，便于拦截抛出"),_={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},m=(0,r.Uk)("3.全局异常处理"),u={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},h=(0,r.Uk)("4.controller层"),p={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},v=(0,r.Uk)("5.拦截器创建"),g={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},U=(0,r.Uk)("6.将拦截器注入应用"),k={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},q=(0,r.Uk)("7.验证查看结果"),z={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},x=(0,r.Uk)("操作权限"),M={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},N=(0,r.Uk)("1.和上面一样使用静态资源"),w={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},T=(0,r.Uk)("2.自定义注解"),A={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},W=(0,r.Uk)("3.controller层"),I={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},R=(0,r.Uk)("4.修改一下之前的拦截器"),S={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},C=(0,r.Uk)("5.验证结果"),y={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},L=(0,r.Uk)("角色权限"),j={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},E=(0,r.Uk)("1.静态对应关系"),P={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},H=(0,r.Uk)("2.修改controller"),B={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},O=(0,r.Uk)("3.修改一下拦截器"),V={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},Z=(0,r.Uk)("4.结果测试"),D={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},Y=(0,r.Uk)("总结"),J=(0,r._)("hr",null,null,-1),F={id:"前言",tabindex:"-1"},G=(0,r._)("a",{class:"header-anchor",href:"#前言","aria-hidden":"true"},"#",-1),K=(0,r.Uk)(),Q={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},X=(0,r.Uk)("前言"),$=(0,r.uE)("<p>提到权限管理这块肯定很多人第一想到的就是Springboot Security或者是Shiro安全框架，但本文介绍的并不是这两种，不是因为他们不好用，实在是自己太懒了，我觉得一个拦截器加上其他的一些处理就能满足项目的需求，我又何必去多用一个框架呢，这篇文章也不是去对比谁好谁坏，各位自行抉择。</p><p>我将权限管理分为三块：</p><ol><li><strong>资源权限</strong> ：将url当做资源，可以给每个账号动态划分Url权限，访问不同的URl；</li><li><strong>操作权限</strong> ：将所有URL分为增、删、改、查4种操作权限，给用户分配对应的操作权限，如某个用户只有查操作权限那么他就无法做其他的操作；</li><li><strong>角色权限</strong> ：系统有多个角色，每个角色的权限都不同，如一个管理后台有着账号管理模块、商品模块等，为超级管理员的角色就可以看到所有模块并操作，而为售后的角色就只能看到商品模块，即使他知道账号管理模块下的URL也无权限操作。然后为用户设置角色就有对应的权限；</li></ol><blockquote><p>“</p><p>推荐下自己做的 Spring Boot 的实战项目：</p><p>https://github.com/YunaiV/ruoyi-vue-pro</p></blockquote>",4),ee={id:"资源权限",tabindex:"-1"},ne=(0,r._)("a",{class:"header-anchor",href:"#资源权限","aria-hidden":"true"},"#",-1),ie=(0,r.Uk)(),re={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},de=(0,r.Uk)("资源权限"),te={id:"_1-静态资源准备",tabindex:"-1"},ae=(0,r._)("a",{class:"header-anchor",href:"#_1-静态资源准备","aria-hidden":"true"},"#",-1),le=(0,r.Uk)(),se={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},ce=(0,r.Uk)("1.静态资源准备"),fe=(0,r.uE)('<p>这里方便演示就不直接操作数据库了，对应的权限建表关系也很简单，这里直接建立静态的用户对应的URL关系。</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>public class Constant {\n    /**\n     * 权限管理\n     */\n    public static Map&lt;Integer,String[]&gt; permission=new HashMap&lt;&gt;();\n    static {\n        String[] frist={&quot;/url1&quot;,&quot;/url2&quot;,&quot;/url3&quot;,&quot;/url4&quot;,&quot;/url5&quot;,&quot;/url6&quot;,&quot;/url7&quot;};//用户1所拥有的URL权限\n        String[] second={&quot;/url1&quot;,&quot;/url2&quot;,&quot;/url3&quot;,&quot;/url4&quot;,&quot;/url5&quot;};//用户2所拥有的URL权限\n        String[] third={&quot;/url1&quot;,&quot;/url2&quot;,&quot;/url3&quot;};//用户3所拥有的URL权限\n        permission.put(1,frist);\n        permission.put(2,second);\n        permission.put(3,third);\n\n    }\n}\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>',2),oe={id:"_2-自定义一个异常-便于拦截抛出",tabindex:"-1"},be=(0,r._)("a",{class:"header-anchor",href:"#_2-自定义一个异常-便于拦截抛出","aria-hidden":"true"},"#",-1),_e=(0,r.Uk)(),me={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},ue=(0,r.Uk)("2.自定义一个异常，便于拦截抛出"),he=(0,r.uE)('<div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>public class APIException extends RuntimeException {\n    private static final long serialVersionUID = 1L;\n    private String msg;\n    public APIException(String msg) {\n        super(msg);\n        this.msg = msg;\n    }\n\n}\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>',1),pe={id:"_3-全局异常处理",tabindex:"-1"},ve=(0,r._)("a",{class:"header-anchor",href:"#_3-全局异常处理","aria-hidden":"true"},"#",-1),ge=(0,r.Uk)(),Ue={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},ke=(0,r.Uk)("3.全局异常处理"),qe=(0,r.uE)('<p>便于异常后返回统一规范的结果,正常应该是正常返回自定义Vo，但这里目标是为了演示结果，再加上各位应该都有自己的Vo类，所以这里就不用了</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>@RestControllerAdvice\npublic class WebExceptionControl {\n    \n    @ExceptionHandler(APIException.class)\n    public String APIExceptionHandler(APIException e) {\n        return e.getMessage();\n    }\n}\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>',2),ze={id:"_4-controller层",tabindex:"-1"},xe=(0,r._)("a",{class:"header-anchor",href:"#_4-controller层","aria-hidden":"true"},"#",-1),Me=(0,r.Uk)(),Ne={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},we=(0,r.Uk)("4.controller层"),Te=(0,r._)("p",null,"很简单创建对应的URL就好",-1),Ae=(0,r._)("p",null,[(0,r._)("img",{src:"https://cdn.jsdelivr.net/gh/jiange1236/MyImage/MdImg/640-164346343241051.webp",alt:"图片"})],-1),We={id:"_5-拦截器创建",tabindex:"-1"},Ie=(0,r._)("a",{class:"header-anchor",href:"#_5-拦截器创建","aria-hidden":"true"},"#",-1),Re=(0,r.Uk)(),Se={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},Ce=(0,r.Uk)("5.拦截器创建"),ye=(0,r.uE)('<p>一般是要先验证token，后根据token取到用户对应信息，这里没有登录所以就直接在token里传对应用户的key值了</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>/**\n * 权限管理URL拦截器\n */\npublic class URLInterceptor implements HandlerInterceptor {\n\n    // 预处理回调方法，在接口调用之前使用  true代表放行  false代表不放行\n    @Override\n    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) {\n        HttpServletRequest httpServletRequest = (HttpServletRequest) request;\n        String token = httpServletRequest.getHeader(&quot;token&quot;);\n        String requestURL = httpServletRequest.getRequestURI();\n        //1.根据token判断用户是否登录\n        if (token==null){   //正常情况下这里还需判断与redis中的token是否匹配\n            // 如果没有token或者token不匹配, 直接抛出异常  提示未登录\n            throw  new APIException(&quot;当前用户未登录&quot;);\n        }\n        //2.登录成功后 根据用户token中的信息获取到用户对应的URL权限集合\n        String[] strings = Constant.permission.get(Integer.valueOf(token));\n        boolean hasPermission = false;\n        //3.再根据用户对应的URL集合去与当前请求的URL对比  有匹配的则放行  反之则抛出异常\n        for (int i =0;i&lt;strings.length;i++) {\n            if (strings[i].equals(requestURL)){\n                hasPermission = true;\n                break;\n            }\n        }\n        if (hasPermission){\n            return true;\n        }else {\n            throw  new APIException(&quot;当前用户没有访问路径&quot; + requestURL + &quot;的权限&quot;);\n        }\n    }\n}\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>',2),Le={id:"_6-将拦截器注入应用",tabindex:"-1"},je=(0,r._)("a",{class:"header-anchor",href:"#_6-将拦截器注入应用","aria-hidden":"true"},"#",-1),Ee=(0,r.Uk)(),Pe={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},He=(0,r.Uk)("6.将拦截器注入应用"),Be=(0,r.uE)('<div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>@Configuration\npublic class WebMvcConfg implements WebMvcConfigurer {\n\n    @Override\n    public void addInterceptors(InterceptorRegistry registry) {\n        //权限拦截器\n        registry.addInterceptor(urlInterceptor()).addPathPatterns(&quot;/**&quot;);\n    }\n    @Bean\n    public URLInterceptor urlInterceptor(){\n        return new URLInterceptor();\n    }\n}\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>',1),Oe={id:"_7-验证查看结果",tabindex:"-1"},Ve=(0,r._)("a",{class:"header-anchor",href:"#_7-验证查看结果","aria-hidden":"true"},"#",-1),Ze=(0,r.Uk)(),De={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},Ye=(0,r.Uk)("7.验证查看结果"),Je=(0,r._)("p",null,"分别在token中传入用户1-3的key，访问不同url就可以看到效果，如下",-1),Fe={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},Ge=(0,r._)("img",{src:"https://cdn.jsdelivr.net/gh/jiange1236/MyImage/MdImg/640-164346343241052.webp",alt:"图片"},null,-1),Ke={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},Qe=(0,r._)("img",{src:"https://cdn.jsdelivr.net/gh/jiange1236/MyImage/MdImg/640-164346343241053.webp",alt:"图片"},null,-1),Xe=(0,r._)("blockquote",null,[(0,r._)("p",null,"“"),(0,r._)("p",null,"推荐下自己做的 Spring Cloud 的实战项目："),(0,r._)("p",null,"https://github.com/YunaiV/onemall")],-1),$e={id:"操作权限",tabindex:"-1"},en=(0,r._)("a",{class:"header-anchor",href:"#操作权限","aria-hidden":"true"},"#",-1),nn=(0,r.Uk)(),rn={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},dn=(0,r.Uk)("操作权限"),tn={id:"_1-和上面一样使用静态资源",tabindex:"-1"},an=(0,r._)("a",{class:"header-anchor",href:"#_1-和上面一样使用静态资源","aria-hidden":"true"},"#",-1),ln=(0,r.Uk)(),sn={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},cn=(0,r.Uk)("1.和上面一样使用静态资源"),fn=(0,r.uE)('<div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>public class Constant {\n    /**\n     * 权限管理\n     */\n    public static Map&lt;Integer,String[]&gt; permission=new HashMap&lt;&gt;();\n    static {\n        String[] frist={&quot;insert&quot;,&quot;delete&quot;,&quot;select&quot;,&quot;update&quot;};//用户1所拥有的操作权限\n        String[] second={&quot;insert&quot;,&quot;select&quot;,&quot;update&quot;};//用户2所拥有的URL权限\n        String[] third={&quot;select&quot;};//用户3所拥有的URL权限\n        permission.put(1,frist);\n        permission.put(2,second);\n        permission.put(3,third);\n\n    }\n}\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>',1),on={id:"_2-自定义注解",tabindex:"-1"},bn=(0,r._)("a",{class:"header-anchor",href:"#_2-自定义注解","aria-hidden":"true"},"#",-1),_n=(0,r.Uk)(),mn={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},un=(0,r.Uk)("2.自定义注解"),hn=(0,r.uE)('<div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>@Target(ElementType.METHOD)\n@Retention(RetentionPolicy.RUNTIME)\npublic @interface UrlAnnotation {\n    /**\n     * 操作类型(type):添加,删除,修改,插入\n     * \n     */\n    String type();\n}\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>',1),pn={id:"_3-controller层",tabindex:"-1"},vn=(0,r._)("a",{class:"header-anchor",href:"#_3-controller层","aria-hidden":"true"},"#",-1),gn=(0,r.Uk)(),Un={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},kn=(0,r.Uk)("3.controller层"),qn=(0,r._)("p",null,"打上自定义的注解，代表对应方法是什么操作",-1),zn={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},xn=(0,r._)("img",{src:"https://cdn.jsdelivr.net/gh/jiange1236/MyImage/MdImg/640-164346343241054.webp",alt:"图片"},null,-1),Mn={id:"_4-修改一下之前的拦截器",tabindex:"-1"},Nn=(0,r._)("a",{class:"header-anchor",href:"#_4-修改一下之前的拦截器","aria-hidden":"true"},"#",-1),wn=(0,r.Uk)(),Tn={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},An=(0,r.Uk)("4.修改一下之前的拦截器"),Wn=(0,r._)("p",null,"添加对注解上面的操作类型的获取，并用type类型去对比判断",-1),In={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},Rn=(0,r._)("img",{src:"https://cdn.jsdelivr.net/gh/jiange1236/MyImage/MdImg/640-164346343241055.webp",alt:"图片"},null,-1),Sn={id:"_5-验证结果",tabindex:"-1"},Cn=(0,r._)("a",{class:"header-anchor",href:"#_5-验证结果","aria-hidden":"true"},"#",-1),yn=(0,r.Uk)(),Ln={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},jn=(0,r.Uk)("5.验证结果"),En=(0,r._)("p",null,"其他都不变",-1),Pn={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},Hn=(0,r._)("img",{src:"https://cdn.jsdelivr.net/gh/jiange1236/MyImage/MdImg/640-164346343241056.webp",alt:"图片"},null,-1),Bn={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},On=(0,r._)("img",{src:"https://cdn.jsdelivr.net/gh/jiange1236/MyImage/MdImg/640-164346343241157.webp",alt:"图片"},null,-1),Vn={id:"角色权限",tabindex:"-1"},Zn=(0,r._)("a",{class:"header-anchor",href:"#角色权限","aria-hidden":"true"},"#",-1),Dn=(0,r.Uk)(),Yn={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},Jn=(0,r.Uk)("角色权限"),Fn=(0,r._)("p",null,"这里其实和上面的操作大同小异，我这里简单演示一下，以两个模块为例",-1),Gn={id:"_1-静态对应关系",tabindex:"-1"},Kn=(0,r._)("a",{class:"header-anchor",href:"#_1-静态对应关系","aria-hidden":"true"},"#",-1),Qn=(0,r.Uk)(),Xn={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},$n=(0,r.Uk)("1.静态对应关系"),ei=(0,r.uE)('<div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>public class Constant {\n    /**\n     * 权限管理\n     */\n    public static Map&lt;Integer,String[]&gt; permission=new HashMap&lt;&gt;();\n    static {\n        String[] frist={&quot;test&quot;,&quot;test1&quot;};//用户1所拥有的模块权限  这里的test是模块URL入口  例如：test模块下所有URL都是/test/**\n        String[] second={&quot;test&quot;};//用户2所拥有的模块权限\n        permission.put(1,frist); //这里的1其实是用户对应ID为1的角色\n        permission.put(2,second);//这个2同理\n\n    }\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>',1),ni={id:"_2-修改controller",tabindex:"-1"},ii=(0,r._)("a",{class:"header-anchor",href:"#_2-修改controller","aria-hidden":"true"},"#",-1),ri=(0,r.Uk)(),di={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},ti=(0,r.Uk)("2.修改controller"),ai=(0,r._)("p",null,"模拟两个模块",-1),li={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},si=(0,r._)("img",{src:"https://cdn.jsdelivr.net/gh/jiange1236/MyImage/MdImg/640-164346343241158.webp",alt:"图片"},null,-1),ci={id:"_3-修改一下拦截器",tabindex:"-1"},fi=(0,r._)("a",{class:"header-anchor",href:"#_3-修改一下拦截器","aria-hidden":"true"},"#",-1),oi=(0,r.Uk)(),bi={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},_i=(0,r.Uk)("3.修改一下拦截器"),mi={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},ui=(0,r._)("img",{src:"https://cdn.jsdelivr.net/gh/jiange1236/MyImage/MdImg/640-164346343241159.webp",alt:"图片"},null,-1),hi={id:"_4-结果测试",tabindex:"-1"},pi=(0,r._)("a",{class:"header-anchor",href:"#_4-结果测试","aria-hidden":"true"},"#",-1),vi=(0,r.Uk)(),gi={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},Ui=(0,r.Uk)("4.结果测试"),ki={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},qi=(0,r._)("img",{src:"https://cdn.jsdelivr.net/gh/jiange1236/MyImage/MdImg/640-164346343241160.webp",alt:"图片"},null,-1),zi={id:"总结",tabindex:"-1"},xi=(0,r._)("a",{class:"header-anchor",href:"#总结","aria-hidden":"true"},"#",-1),Mi=(0,r.Uk)(),Ni={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},wi=(0,r.Uk)("总结"),Ti=(0,r._)("p",null,"其实用自定义的拦截器去做权限，不管是什么类型其实都大同小异，根据需求灵活的去处理才是最重要的，上面的静态权限变通一下，建立角色表、用户表、路径表以及对应关系，就很容易做出URL的动态权限配置了，灵活运用自定义注解搭配可以做到更细致。",-1),Ai={},Wi=(0,i(83744).Z)(Ai,[["render",function(e,n){const i=(0,r.up)("ExternalLinkIcon");return(0,r.wg)(),(0,r.iD)("div",null,[d,(0,r._)("ul",null,[(0,r._)("li",null,[(0,r._)("p",null,[(0,r._)("a",t,[a,(0,r.Wm)(i)])])]),(0,r._)("li",null,[(0,r._)("p",null,[(0,r._)("a",l,[s,(0,r.Wm)(i)])])]),(0,r._)("li",null,[(0,r._)("ul",null,[(0,r._)("li",null,[(0,r._)("a",c,[f,(0,r.Wm)(i)])]),(0,r._)("li",null,[(0,r._)("a",o,[b,(0,r.Wm)(i)])]),(0,r._)("li",null,[(0,r._)("a",_,[m,(0,r.Wm)(i)])]),(0,r._)("li",null,[(0,r._)("a",u,[h,(0,r.Wm)(i)])]),(0,r._)("li",null,[(0,r._)("a",p,[v,(0,r.Wm)(i)])]),(0,r._)("li",null,[(0,r._)("a",g,[U,(0,r.Wm)(i)])]),(0,r._)("li",null,[(0,r._)("a",k,[q,(0,r.Wm)(i)])])])]),(0,r._)("li",null,[(0,r._)("p",null,[(0,r._)("a",z,[x,(0,r.Wm)(i)])])]),(0,r._)("li",null,[(0,r._)("ul",null,[(0,r._)("li",null,[(0,r._)("a",M,[N,(0,r.Wm)(i)])]),(0,r._)("li",null,[(0,r._)("a",w,[T,(0,r.Wm)(i)])]),(0,r._)("li",null,[(0,r._)("a",A,[W,(0,r.Wm)(i)])]),(0,r._)("li",null,[(0,r._)("a",I,[R,(0,r.Wm)(i)])]),(0,r._)("li",null,[(0,r._)("a",S,[C,(0,r.Wm)(i)])])])]),(0,r._)("li",null,[(0,r._)("p",null,[(0,r._)("a",y,[L,(0,r.Wm)(i)])])]),(0,r._)("li",null,[(0,r._)("ul",null,[(0,r._)("li",null,[(0,r._)("a",j,[E,(0,r.Wm)(i)])]),(0,r._)("li",null,[(0,r._)("a",P,[H,(0,r.Wm)(i)])]),(0,r._)("li",null,[(0,r._)("a",B,[O,(0,r.Wm)(i)])]),(0,r._)("li",null,[(0,r._)("a",V,[Z,(0,r.Wm)(i)])])])]),(0,r._)("li",null,[(0,r._)("p",null,[(0,r._)("a",D,[Y,(0,r.Wm)(i)])])])]),J,(0,r._)("h2",F,[G,K,(0,r._)("a",Q,[X,(0,r.Wm)(i)])]),$,(0,r._)("h2",ee,[ne,ie,(0,r._)("a",re,[de,(0,r.Wm)(i)])]),(0,r._)("h3",te,[ae,le,(0,r._)("a",se,[ce,(0,r.Wm)(i)])]),fe,(0,r._)("h3",oe,[be,_e,(0,r._)("a",me,[ue,(0,r.Wm)(i)])]),he,(0,r._)("h3",pe,[ve,ge,(0,r._)("a",Ue,[ke,(0,r.Wm)(i)])]),qe,(0,r._)("h3",ze,[xe,Me,(0,r._)("a",Ne,[we,(0,r.Wm)(i)])]),Te,Ae,(0,r._)("h3",We,[Ie,Re,(0,r._)("a",Se,[Ce,(0,r.Wm)(i)])]),ye,(0,r._)("h3",Le,[je,Ee,(0,r._)("a",Pe,[He,(0,r.Wm)(i)])]),Be,(0,r._)("h3",Oe,[Ve,Ze,(0,r._)("a",De,[Ye,(0,r.Wm)(i)])]),Je,(0,r._)("p",null,[(0,r._)("a",Fe,[Ge,(0,r.Wm)(i)])]),(0,r._)("p",null,[(0,r._)("a",Ke,[Qe,(0,r.Wm)(i)])]),Xe,(0,r._)("h2",$e,[en,nn,(0,r._)("a",rn,[dn,(0,r.Wm)(i)])]),(0,r._)("h3",tn,[an,ln,(0,r._)("a",sn,[cn,(0,r.Wm)(i)])]),fn,(0,r._)("h3",on,[bn,_n,(0,r._)("a",mn,[un,(0,r.Wm)(i)])]),hn,(0,r._)("h3",pn,[vn,gn,(0,r._)("a",Un,[kn,(0,r.Wm)(i)])]),qn,(0,r._)("p",null,[(0,r._)("a",zn,[xn,(0,r.Wm)(i)])]),(0,r._)("h3",Mn,[Nn,wn,(0,r._)("a",Tn,[An,(0,r.Wm)(i)])]),Wn,(0,r._)("p",null,[(0,r._)("a",In,[Rn,(0,r.Wm)(i)])]),(0,r._)("h3",Sn,[Cn,yn,(0,r._)("a",Ln,[jn,(0,r.Wm)(i)])]),En,(0,r._)("p",null,[(0,r._)("a",Pn,[Hn,(0,r.Wm)(i)])]),(0,r._)("p",null,[(0,r._)("a",Bn,[On,(0,r.Wm)(i)])]),(0,r._)("h2",Vn,[Zn,Dn,(0,r._)("a",Yn,[Jn,(0,r.Wm)(i)])]),Fn,(0,r._)("h3",Gn,[Kn,Qn,(0,r._)("a",Xn,[$n,(0,r.Wm)(i)])]),ei,(0,r._)("h3",ni,[ii,ri,(0,r._)("a",di,[ti,(0,r.Wm)(i)])]),ai,(0,r._)("p",null,[(0,r._)("a",li,[si,(0,r.Wm)(i)])]),(0,r._)("h3",ci,[fi,oi,(0,r._)("a",bi,[_i,(0,r.Wm)(i)])]),(0,r._)("p",null,[(0,r._)("a",mi,[ui,(0,r.Wm)(i)])]),(0,r._)("h3",hi,[pi,vi,(0,r._)("a",gi,[Ui,(0,r.Wm)(i)])]),(0,r._)("p",null,[(0,r._)("a",ki,[qi,(0,r.Wm)(i)])]),(0,r._)("h2",zi,[xi,Mi,(0,r._)("a",Ni,[wi,(0,r.Wm)(i)])]),Ti])}]])},83744:(e,n)=>{n.Z=(e,n)=>{const i=e.__vccOpts||e;for(const[e,r]of n)i[e]=r;return i}},26569:(e,n,i)=>{i.r(n),i.d(n,{data:()=>r});const r=JSON.parse('{"key":"v-33105d07","path":"/others/SpringBoot.html","title":"SpringBoot+拦截器+自定义异常+自定义注解+全局异常处理","lang":"zh-CN","frontmatter":{"author":"jiange1236","title":"SpringBoot+拦截器+自定义异常+自定义注解+全局异常处理","description":"SpringBoot+拦截器+自定义异常+自定义注解+全局异常处理","date":"2022-01-15T00:00:00.000Z","category":"other","tag":"other","article":true,"timeline":true,"icon":null,"password":null},"excerpt":"","headers":[{"level":1,"title":"SpringBoot+拦截器+自定义异常+自定义注解+全局异常处理","slug":"springboot-拦截器-自定义异常-自定义注解-全局异常处理","children":[{"level":3,"title":"1.静态资源准备","slug":"_1-静态资源准备","children":[]},{"level":3,"title":"2.自定义一个异常，便于拦截抛出","slug":"_2-自定义一个异常-便于拦截抛出","children":[]},{"level":3,"title":"3.全局异常处理","slug":"_3-全局异常处理","children":[]},{"level":3,"title":"4.controller层","slug":"_4-controller层","children":[]},{"level":3,"title":"5.拦截器创建","slug":"_5-拦截器创建","children":[]},{"level":3,"title":"6.将拦截器注入应用","slug":"_6-将拦截器注入应用","children":[]},{"level":3,"title":"7.验证查看结果","slug":"_7-验证查看结果","children":[]},{"level":3,"title":"1.和上面一样使用静态资源","slug":"_1-和上面一样使用静态资源","children":[]},{"level":3,"title":"2.自定义注解","slug":"_2-自定义注解","children":[]},{"level":3,"title":"3.controller层","slug":"_3-controller层","children":[]},{"level":3,"title":"4.修改一下之前的拦截器","slug":"_4-修改一下之前的拦截器","children":[]},{"level":3,"title":"5.验证结果","slug":"_5-验证结果","children":[]},{"level":3,"title":"1.静态对应关系","slug":"_1-静态对应关系","children":[]},{"level":3,"title":"2.修改controller","slug":"_2-修改controller","children":[]},{"level":3,"title":"3.修改一下拦截器","slug":"_3-修改一下拦截器","children":[]},{"level":3,"title":"4.结果测试","slug":"_4-结果测试","children":[]}]}],"git":{"updatedTime":1652532191000,"contributors":[{"name":"jiange1236","email":"183465355@qq.com","commits":4}]},"filePathRelative":"others/SpringBoot.md"}')}}]);